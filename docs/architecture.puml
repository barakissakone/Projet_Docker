@startuml
title RDV Medical - Diagramme de composants (Docker)

skinparam componentStyle rectangle
skinparam shadowing false

component "Utilisateur\n(Navigateur)" as user

node "Docker Network : internal" {

  component "cloudflared\n(Cloudflare Tunnel)\nHTTPS public" as cloudflared

  component "Caddy\nReverse Proxy\nPoint d'entrée unique" as caddy

  component "App PHP\nGestion RDV médicaux" as app

  component "phpMyAdmin\n(Admin DB)" as pma

  database "MySQL\nDB\nVolume: db_data\n(persistance)" as db
}

user --> cloudflared : HTTPS\n(domaine public)
cloudflared --> caddy : HTTP interne

caddy --> app : reverse_proxy\n/ -> app:80
caddy --> pma : reverse_proxy\n:8082 -> phpMyAdmin

app --> db : SQL (3306)
pma --> db : SQL (3306)

note right of caddy
- Point d'entrée unique
- Reverse proxy HTTP
- Aucun accès direct aux services internes
end note

note right of db
- Données persistantes (volume Docker)
- Base non exposée publiquement
- Accessible uniquement via le réseau interne
end note

@enduml
